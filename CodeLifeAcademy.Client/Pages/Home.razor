@page "/"
@inject HttpClient _http
@inject NavigationManager _navManager

<PageTitle>Курсы</PageTitle>

<h3>Курсы</h3>

@if (_courses is null)
{
    <p>Загрузка страницы...</p>
}
else {
    <div class="grid" >
        @foreach (var course in _courses)
        {
            <CourseCard Course="course" OnSelected="HandleCourseSelected"/>
        }
    </div>
}


@code {
    private IEnumerable<Course>? _courses;

    protected override async Task OnInitializedAsync() {
        try {
            _courses = await _http.GetFromJsonAsync<IEnumerable<Course>>("/courses");
        }
        catch (HttpRequestException ex) {
            Console.WriteLine($"Ошибка при загрузке курсов {ex.Message}");
        }
    }

    private void HandleCourseSelected() =>
        _navManager.NavigateTo("/topicsPage");
}
